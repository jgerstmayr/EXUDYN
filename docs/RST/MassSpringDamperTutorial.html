<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Mass-Spring-Damper tutorial &mdash; Exudyn 1.5.95.dev1 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/rtd_sphinx_search.min.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
        <script src="../../_static/js/rtd_sphinx_search.min.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Rigid body and joints tutorial" href="RigidBodyAndJointsTutorial.html" />
    <link rel="prev" title="Tutorial" href="Tutorial.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            Exudyn
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Exudyn User Manual</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Exudyn.html">Exudyn</a></li>
<li class="toctree-l1"><a class="reference internal" href="InstallationAndGettingStartedIndex.html">Installation and Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="OverviewOnExudynIndex.html">Overview on Exudyn</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="TutorialIndex.html">Tutorial</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Tutorial.html">Tutorial</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Mass-Spring-Damper tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="RigidBodyAndJointsTutorial.html">Rigid body and joints tutorial</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference Manual</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pythonUtilities/index.html">Python Utility Functions</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Issue Tracker</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../trackerlogRST.html">Issue tracker</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Exudyn</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="TutorialIndex.html">Tutorial</a></li>
      <li class="breadcrumb-item active">Mass-Spring-Damper tutorial</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/docs/RST/MassSpringDamperTutorial.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="mass-spring-damper-tutorial">
<h1>Mass-Spring-Damper tutorial<a class="headerlink" href="#mass-spring-damper-tutorial" title="Permalink to this heading"></a></h1>
<p>The python source code of the first tutorial can be found in the file:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">main/pythonDev/Examples/springDamperTutorial.py</span></code></p>
</div></blockquote>
<p>This tutorial will set up a mass point and a spring damper, dynamically compute the solution and evaluate the reference solution.</p>
<p>We import the exudyn library and the interface for all nodes, objects, markers, loads and sensors:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">exudyn</span> <span class="k">as</span> <span class="nn">exu</span>
<span class="kn">from</span> <span class="nn">exudyn.itemInterface</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> <span class="c1">#for postprocessing</span>
</pre></div>
</div>
<p>Next, we need a <code class="docutils literal notranslate"><span class="pre">SystemContainer</span></code>, which contains all computable systems and add a new MainSystem <code class="docutils literal notranslate"><span class="pre">mbs</span></code>.
Per default, you always should name your system ‘mbs’ (multibody system), in order to copy/paste code parts from other examples, tutorials and other projects:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">SC</span> <span class="o">=</span> <span class="n">exu</span><span class="o">.</span><span class="n">SystemContainer</span><span class="p">()</span>
<span class="n">mbs</span> <span class="o">=</span> <span class="n">SC</span><span class="o">.</span><span class="n">AddSystem</span><span class="p">()</span>
</pre></div>
</div>
<p>In order to check, which version you are using, you can printout the current Exudyn version. This version is in line with the issue tracker and marks the number of open/closed issues added to Exudyn :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;EXUDYN version=&#39;</span><span class="o">+</span><span class="n">exu</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
</pre></div>
</div>
<p>Using the powerful Python language, we can define some variables for our problem, which will also be used for the analytical solution:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">L</span><span class="o">=</span><span class="mf">0.5</span>               <span class="c1">#reference position of mass</span>
<span class="n">mass</span> <span class="o">=</span> <span class="mf">1.6</span>          <span class="c1">#mass in kg</span>
<span class="n">spring</span> <span class="o">=</span> <span class="mi">4000</span>       <span class="c1">#stiffness of spring-damper in N/m</span>
<span class="n">damper</span> <span class="o">=</span> <span class="mi">8</span>          <span class="c1">#damping constant in N/(m/s)</span>
<span class="n">f</span> <span class="o">=</span><span class="mi">80</span>               <span class="c1">#force on mass</span>
</pre></div>
</div>
<p>For the simple spring-mass-damper system, we need initial displacements and velocities:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">u0</span><span class="o">=-</span><span class="mf">0.08</span>            <span class="c1">#initial displacement</span>
<span class="n">v0</span><span class="o">=</span><span class="mi">1</span>                <span class="c1">#initial velocity</span>
<span class="n">x0</span><span class="o">=</span><span class="n">f</span><span class="o">/</span><span class="n">spring</span>         <span class="c1">#static displacement</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;resonance frequency = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">spring</span><span class="o">/</span><span class="n">mass</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;static displacement = &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">x0</span><span class="p">))</span>
</pre></div>
</div>
<p>We first need to add nodes, which provide the coordinates (and the degrees of freedom) to the system.
The following line adds a 3D node for 3D mass point (Note: Point is an abbreviation for NodePoint, defined in <code class="docutils literal notranslate"><span class="pre">itemInterface.py</span></code>.):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">n1</span><span class="o">=</span><span class="n">mbs</span><span class="o">.</span><span class="n">AddNode</span><span class="p">(</span><span class="n">Point</span><span class="p">(</span><span class="n">referenceCoordinates</span> <span class="o">=</span> <span class="p">[</span><span class="n">L</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
                     <span class="n">initialCoordinates</span> <span class="o">=</span> <span class="p">[</span><span class="n">u0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
                     <span class="n">initialVelocities</span> <span class="o">=</span> <span class="p">[</span><span class="n">v0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
<p>Here, <code class="docutils literal notranslate"><span class="pre">Point</span></code> (=<code class="docutils literal notranslate"><span class="pre">NodePoint</span></code>) is a Python class, which takes a number of arguments defined in the reference manual. The arguments here are <code class="docutils literal notranslate"><span class="pre">referenceCoordinates</span></code>, which are the coordinates for which the system is defined. The initial configuration is given by <code class="docutils literal notranslate"><span class="pre">referenceCoordinates</span> <span class="pre">+</span> <span class="pre">initialCoordinates</span></code>, while the initial state additionally gets <code class="docutils literal notranslate"><span class="pre">initialVelocities</span></code>.
The command <code class="docutils literal notranslate"><span class="pre">mbs.AddNode(...)</span></code> returns a <code class="docutils literal notranslate"><span class="pre">NodeIndex</span> <span class="pre">n1</span></code>, which basically contains an integer, which can only be used as node number. This node number will be used lateron to use the node in the object or in the marker.</p>
<p>While <code class="docutils literal notranslate"><span class="pre">Point</span></code> adds 3 unknown coordinates to the system, which need to be solved, we also can add ground nodes, which can be used similar to nodes, but they do not have unknown coordinates – and therefore also have no initial displacements or velocities. The advantage of ground nodes (and ground bodies) is that no constraints are needed to fix these nodes.
Such a ground node is added via:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">nGround</span><span class="o">=</span><span class="n">mbs</span><span class="o">.</span><span class="n">AddNode</span><span class="p">(</span><span class="n">NodePointGround</span><span class="p">(</span><span class="n">referenceCoordinates</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
<p>In the next step, we add an object (sec:programStructure.), which provides equations for coordinates. The <code class="docutils literal notranslate"><span class="pre">MassPoint</span></code> needs at least a mass (kg) and a node number to which the mass point is attached. Additionally, graphical objects could be attached:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">massPoint</span> <span class="o">=</span> <span class="n">mbs</span><span class="o">.</span><span class="n">AddObject</span><span class="p">(</span><span class="n">MassPoint</span><span class="p">(</span><span class="n">physicsMass</span> <span class="o">=</span> <span class="n">mass</span><span class="p">,</span> <span class="n">nodeNumber</span> <span class="o">=</span> <span class="n">n1</span><span class="p">))</span>
</pre></div>
</div>
<p>In order to apply constraints and loads, we need markers. These markers are used as local positions (and frames), where we can attach a constraint lateron. In this example, we work on the coordinate level, both for forces as well as for constraints.
Markers are attached to the according ground and regular node number, additionally using a coordinate number (0 … first coordinate):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">groundMarker</span><span class="o">=</span><span class="n">mbs</span><span class="o">.</span><span class="n">AddMarker</span><span class="p">(</span><span class="n">MarkerNodeCoordinate</span><span class="p">(</span><span class="n">nodeNumber</span><span class="o">=</span> <span class="n">nGround</span><span class="p">,</span>
                                                <span class="n">coordinate</span> <span class="o">=</span> <span class="mi">0</span><span class="p">))</span>
<span class="c1">#marker for springDamper for first (x-)coordinate:</span>
<span class="n">nodeMarker</span> <span class="o">=</span> <span class="n">mbs</span><span class="o">.</span><span class="n">AddMarker</span><span class="p">(</span><span class="n">MarkerNodeCoordinate</span><span class="p">(</span><span class="n">nodeNumber</span><span class="o">=</span> <span class="n">n1</span><span class="p">,</span>
                                                <span class="n">coordinate</span> <span class="o">=</span> <span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
<p>This means that loads can be applied to the first coordinate of node <code class="docutils literal notranslate"><span class="pre">n1</span></code> via marker with number <code class="docutils literal notranslate"><span class="pre">nodeMarker</span></code>,
which is in fact of type <code class="docutils literal notranslate"><span class="pre">MarkerIndex</span></code>.</p>
<p>Now we add a spring-damper to the markers with numbers <code class="docutils literal notranslate"><span class="pre">groundMarker</span></code> and the <code class="docutils literal notranslate"><span class="pre">nodeMarker</span></code>, providing stiffness and damping parameters:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">nC</span> <span class="o">=</span> <span class="n">mbs</span><span class="o">.</span><span class="n">AddObject</span><span class="p">(</span><span class="n">CoordinateSpringDamper</span><span class="p">(</span><span class="n">markerNumbers</span> <span class="o">=</span> <span class="p">[</span><span class="n">groundMarker</span><span class="p">,</span> <span class="n">nodeMarker</span><span class="p">],</span>
                                     <span class="n">stiffness</span> <span class="o">=</span> <span class="n">spring</span><span class="p">,</span>
                                     <span class="n">damping</span> <span class="o">=</span> <span class="n">damper</span><span class="p">))</span>
</pre></div>
</div>
<p>A load is added to marker <code class="docutils literal notranslate"><span class="pre">nodeMarker</span></code>, with a scalar load with value <code class="docutils literal notranslate"><span class="pre">f</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">nLoad</span> <span class="o">=</span> <span class="n">mbs</span><span class="o">.</span><span class="n">AddLoad</span><span class="p">(</span><span class="n">LoadCoordinate</span><span class="p">(</span><span class="n">markerNumber</span> <span class="o">=</span> <span class="n">nodeMarker</span><span class="p">,</span>
                                   <span class="n">load</span> <span class="o">=</span> <span class="n">f</span><span class="p">))</span>
</pre></div>
</div>
<p>Finally, a sensor is added to the coordinate constraint object with number <code class="docutils literal notranslate"><span class="pre">nC</span></code>, requesting the <code class="docutils literal notranslate"><span class="pre">outputVariableType</span></code> <code class="docutils literal notranslate"><span class="pre">Force</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mbs</span><span class="o">.</span><span class="n">AddSensor</span><span class="p">(</span><span class="n">SensorObject</span><span class="p">(</span><span class="n">objectNumber</span><span class="o">=</span><span class="n">nC</span><span class="p">,</span> <span class="n">fileName</span><span class="o">=</span><span class="s1">&#39;groundForce.txt&#39;</span><span class="p">,</span>
                           <span class="n">outputVariableType</span><span class="o">=</span><span class="n">exu</span><span class="o">.</span><span class="n">OutputVariableType</span><span class="o">.</span><span class="n">Force</span><span class="p">))</span>
</pre></div>
</div>
<p>Note that sensors can be attached, e.g., to nodes, bodies, objects (constraints) or loads.
As our system is fully set, we can print the overall information and assemble the system to make it ready for simulation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">mbs</span><span class="p">)</span>
<span class="n">mbs</span><span class="o">.</span><span class="n">Assemble</span><span class="p">()</span>
</pre></div>
</div>
<p>We will use time integration and therefore define a number of steps (fixed step size; must be provided) and the total time span for the simulation:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tEnd</span> <span class="o">=</span> <span class="mi">1</span>     <span class="c1">#end time of simulation</span>
<span class="n">h</span> <span class="o">=</span> <span class="mf">0.001</span>    <span class="c1">#step size; leads to 1000 steps</span>
</pre></div>
</div>
<p>All settings for simulation, see according reference section, can be provided in a structure given from <code class="docutils literal notranslate"><span class="pre">exu.SimulationSettings()</span></code>. Note that this structure will contain all default values, and only non-default values need to be provided:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">simulationSettings</span> <span class="o">=</span> <span class="n">exu</span><span class="o">.</span><span class="n">SimulationSettings</span><span class="p">()</span>
<span class="n">simulationSettings</span><span class="o">.</span><span class="n">solutionSettings</span><span class="o">.</span><span class="n">solutionWritePeriod</span> <span class="o">=</span> <span class="mf">5e-3</span> <span class="c1">#output interval general</span>
<span class="n">simulationSettings</span><span class="o">.</span><span class="n">solutionSettings</span><span class="o">.</span><span class="n">sensorsWritePeriod</span> <span class="o">=</span> <span class="mf">5e-3</span>  <span class="c1">#output interval of sensors</span>
<span class="n">simulationSettings</span><span class="o">.</span><span class="n">timeIntegration</span><span class="o">.</span><span class="n">numberOfSteps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">tEnd</span><span class="o">/</span><span class="n">h</span><span class="p">)</span> <span class="c1">#must be integer</span>
<span class="n">simulationSettings</span><span class="o">.</span><span class="n">timeIntegration</span><span class="o">.</span><span class="n">endTime</span> <span class="o">=</span> <span class="n">tEnd</span>
</pre></div>
</div>
<p>We are using a generalized alpha solver, where numerical damping is needed for index 3 constraints. As we have only spring-dampers, we can set the spectral radius to 1, meaning no numerical damping:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">simulationSettings</span><span class="o">.</span><span class="n">timeIntegration</span><span class="o">.</span><span class="n">generalizedAlpha</span><span class="o">.</span><span class="n">spectralRadius</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
<p>In order to visualize the results online, a renderer can be started. As our computation will be very fast, it is a good idea to wait for the user to press SPACE, before starting the simulation (uncomment second line):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">exu</span><span class="o">.</span><span class="n">StartRenderer</span><span class="p">()</span>              <span class="c1">#start graphics visualization</span>
<span class="c1">#mbs.WaitForUserToContinue()     #wait for pressing SPACE bar to continue (in render window!)</span>
</pre></div>
</div>
<p>As the simulation is still very fast, we will not see the motion of our node. Using e.g. <code class="docutils literal notranslate"><span class="pre">steps=10000000</span></code> in the lines above allows you online visualize the resulting oscillations.</p>
<p>Finally, we start the solver, by telling which system to be solved, solver type and the simulation settings:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">exu</span><span class="o">.</span><span class="n">SolveDynamic</span><span class="p">(</span><span class="n">mbs</span><span class="p">,</span> <span class="n">simulationSettings</span><span class="p">)</span>
</pre></div>
</div>
<p>After simulation, our renderer needs to be stopped (otherwise it would stay in background and prohibit further simulations).
Sometimes you would like to wait until closing the render window, using <code class="docutils literal notranslate"><span class="pre">WaitForRenderEngineStopFlag()</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#SC.WaitForRenderEngineStopFlag()#wait for pressing &#39;Q&#39; to quit</span>
<span class="n">exu</span><span class="o">.</span><span class="n">StopRenderer</span><span class="p">()</span>               <span class="c1">#safely close rendering window!</span>
</pre></div>
</div>
<p>There are several ways to evaluate results, see the reference pages. In the following we take the final value of node <code class="docutils literal notranslate"><span class="pre">n1</span></code> and read its 3D position vector:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#evaluate final (=current) output values</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">mbs</span><span class="o">.</span><span class="n">GetNodeOutput</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span> <span class="n">exu</span><span class="o">.</span><span class="n">OutputVariableType</span><span class="o">.</span><span class="n">Position</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;displacement=&#39;</span><span class="p">,</span><span class="n">u</span><span class="p">)</span>
</pre></div>
</div>
<p>The following code generates a reference (exact) solution for our example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.ticker</span> <span class="k">as</span> <span class="nn">ticker</span>

<span class="n">omega0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">spring</span><span class="o">/</span><span class="n">mass</span><span class="p">)</span>          <span class="c1">#eigen frequency of undamped system</span>
<span class="n">dRel</span> <span class="o">=</span> <span class="n">damper</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">spring</span><span class="o">*</span><span class="n">mass</span><span class="p">))</span> <span class="c1">#dimensionless damping</span>
<span class="n">omega</span> <span class="o">=</span> <span class="n">omega0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">dRel</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>      <span class="c1">#eigen freq of damped system</span>
<span class="n">C1</span> <span class="o">=</span> <span class="n">u0</span><span class="o">-</span><span class="n">x0</span> <span class="c1">#static solution needs to be considered!</span>
<span class="n">C2</span> <span class="o">=</span> <span class="p">(</span><span class="n">v0</span><span class="o">+</span><span class="n">omega0</span><span class="o">*</span><span class="n">dRel</span><span class="o">*</span><span class="n">C1</span><span class="p">)</span> <span class="o">/</span> <span class="n">omega</span>       <span class="c1">#C1, C2 are coeffs for solution</span>
<span class="n">steps</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">tEnd</span><span class="o">/</span><span class="n">h</span><span class="p">)</span>                    <span class="c1">#use same steps for reference solution</span>

<span class="n">refSol</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">steps</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">steps</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
  <span class="n">t</span> <span class="o">=</span> <span class="n">tEnd</span><span class="o">*</span><span class="n">i</span><span class="o">/</span><span class="n">steps</span>
  <span class="n">refSol</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span>
  <span class="n">refSol</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">omega0</span><span class="o">*</span><span class="n">dRel</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">C1</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">+</span><span class="n">C2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">omega</span><span class="o">*</span><span class="n">t</span><span class="p">))</span><span class="o">+</span><span class="n">x0</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">refSol</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">refSol</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;displacement (m); exact solution&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now we can load our results from the default solution file <code class="docutils literal notranslate"><span class="pre">coordinatesSolution.txt</span></code>, which is in the same
directory as your python tutorial file.
<strong>Note</strong> that the visualization of results can be simplified considerably using the <code class="docutils literal notranslate"><span class="pre">PlotSensor(...)</span></code> utility function as shown in the <strong>Rigid body and joints tutorial</strong>!</p>
<p>For reading the file containing commented lines (this does not work in binary mode!), we use a numpy feature and finally plot the displacement of coordinate 0 or our mass point (<code class="docutils literal notranslate"><span class="pre">data[:,0]</span></code> contains the simulation time, <code class="docutils literal notranslate"><span class="pre">data[:,1]</span></code> contains displacement of (global) coordinate 0, <code class="docutils literal notranslate"><span class="pre">data[:,2]</span></code> contains displacement of (global) coordinate 1, …)):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;coordinatesSolution.txt&#39;</span><span class="p">,</span> <span class="n">comments</span><span class="o">=</span><span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;displacement (m); numerical solution&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The sensor result can be loaded in the same way. The sensor output format contains time in the first column and sensor values in the remaining columns. The number of columns depends on the
sensor and the output quantity (scalar, vector, …):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">&#39;groundForce.txt&#39;</span><span class="p">,</span> <span class="n">comments</span><span class="o">=</span><span class="s1">&#39;#&#39;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mf">1e-3</span><span class="p">,</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;force (kN)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>In order to get a nice plot within Spyder, the following options can be used (note, in some environments you need finally the command <code class="docutils literal notranslate"><span class="pre">plt.show()</span></code>):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span> <span class="c1"># get current axes</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="s1">&#39;both&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span> <span class="c1">#show labels as legend</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>The matplotlib output should look like this:</p>
<a class="reference internal image-reference" href="../../_images/plotSpringDamper.png"><img alt="../../_images/plotSpringDamper.png" src="../../_images/plotSpringDamper.png" style="width: 400px;" /></a>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Tutorial.html" class="btn btn-neutral float-left" title="Tutorial" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="RigidBodyAndJointsTutorial.html" class="btn btn-neutral float-right" title="Rigid body and joints tutorial" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Johannes Gerstmayr.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>